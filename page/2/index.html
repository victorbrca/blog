<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Victor&#39;s Blog </title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="" />

<meta name="keywords" content="">


<meta property="og:title" content="Victor&#39;s Blog ">
<meta property="og:site_name" content="Victor&#39;s Blog"/>
<meta property="og:url" content="https://blog.victormendonca.com/" />
<meta property="og:locale" content="en">


<meta property="og:type" content="website" />



<link href="https://blog.victormendonca.com/index.xml" rel="alternate" type="application/rss+xml" title="Victor&#39;s Blog" />

<link rel="canonical" href="https://blog.victormendonca.com/" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://blog.victormendonca.com/touch-icon-144-precomposed.png">
<link rel="icon" href="https://blog.victormendonca.com/favicon.png">
<meta name="generator" content="Hugo 0.48" />

  <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->



    <link rel="stylesheet" href="https://blog.victormendonca.com/css/bootswatch/default/bootstrap.min.css">


<link rel="stylesheet" href="https://blog.victormendonca.com/css/font-awesome.min.css">
<link rel="stylesheet" href="https://blog.victormendonca.com/css/style.css">


<link rel="stylesheet" href="https://blog.victormendonca.com/css/style_custom.css">



  <link rel="stylesheet" href="https://blog.victormendonca.com/css/highlight/github.css">



  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1P1YY6BDG2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() { dataLayer.push(arguments); }
      gtag('js', new Date());

      gtag('config', 'G-1P1YY6BDG2');
    </script>
  

</head>
<body class="map[name:default]" data-ng-app="myapp" data-ng-controller="MyController" data-ng-mouseleave="MouseLeave($event)">
    <header id="main-header">
  <nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        
        <a class="navbar-brand" href="https://blog.victormendonca.com/">
          Victor&#39;s Blog
          
          
          </a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            
            
            <li class="">

              <a href="https://blog.victormendonca.com/" >
                
                Home
              </a>
            </li>
            
            <li class="">

              <a href="https://blog.victormendonca.com/about/" >
                
                About
              </a>
            </li>
            
            <li class="">

              <a href="https://geekit.ca/" >
                
                Professional
              </a>
            </li>
            
            <li class="">

              <a href="https://manhattan.victormendonca.com/" >
                
                Manhattan Blog
              </a>
            </li>
            
            
            
          </ul>
        </div>
        
      </div>
    </nav>
  </header>


  <div class="container">
    
    <div class="row">
      <div class="col-sm-9">
        
        
          <div>
  <h2><a href="https://blog.victormendonca.com/2023/11/21/testing-new-hard-drives/">Testing New Hard Drives</a>
</h2>

  <div class="margin-10">
    <small>
  <i class="fa fa-calendar"></i>
  <time datetime="2023-11-21">21 Nov, 2023</time>
</small>

    
  <i class="fa fa-tags"></i>
  
  <a href="https://blog.victormendonca.com/tags/hardware" class="label label-primary">Hardware</a>
  
  <a href="https://blog.victormendonca.com/tags/storage" class="label label-primary">Storage</a>
  
  <a href="https://blog.victormendonca.com/tags/linux" class="label label-primary">Linux</a>
  


  </div>
</div>

          <div class="content">
  

<p>So you got a spanking new hard drive for your NAS and you are ready to install it&hellip; but wait! What if the drive is bad?</p>

<p><img src="https://i.imgur.com/XlwZRg7l.png" alt="" /></p>

<p>This is not something that most people would think of, but that shiny new drive could already have come with defects (a.k.a extra features) from the factory. Or maybe it was part of a fun game of &ldquo;throw the client&rsquo;s package&rdquo; that some delivery man like to play (as my preferred social media likes to show me). So before we install this new piece of hardware that has the potential to render all my data, accumulated from years of hoarding, useless, let&rsquo;s do some testing.</p>

<h2 id="s-m-a-r-t-testing">S.M.A.R.T Testing</h2>

<p>Let&rsquo;s start with a S.M.A.R.T (Self-Monitoring, Analysis, and Reporting Technology) test.</p>

<p><img src="https://i.imgur.com/4LQP5Iz.png" alt="smart" /></p>

<blockquote>
<p><a href="https://support-en.wd.com/app/answers/detailweb/a_id/39617/~/self-monitoring%2C-analysis-and-reporting-technology-%28s.m.a.r.t.%29">Wikipedia: Self-Monitoring, Analysis and Reporting Technology (S.M.A.R.T.)</a></p>

<p>SMART is an interface between the platform&rsquo;s BIOS and the storage device. When SMART is enabled in the BIOS (mostly default), the BIOS can process information from the storage device and determine whether to send a warning message about potential failure of the storage device. The purpose of SMART is to warn a user of impending drive failure while there is still time to take action, such as backing up the data or copying the data to a replacement device.</p>
</blockquote>

<p>First we need to identify if the drive is capable of S.M.A.R.T test. Most modern drives should be.</p>

<pre><code class="language-none">sudo smartctl -i /dev/sdX
</code></pre>

<p>You should get an output similar to the one below:</p>

<pre><code class="language-none">=== START OF INFORMATION SECTION ===
Device Model:     WDC WD60EFPX-68C5ZN0
Serial Number:    WD-WX12D12312345
LU WWN Device Id: 5 0014ee 26b395dd4
Firmware Version: 81.00A81
User Capacity:    6,001,175,126,016 bytes [6.00 TB]
Sector Sizes:     512 bytes logical, 4096 bytes physical
Rotation Rate:    5400 rpm
Form Factor:      3.5 inches
Device is:        Not in smartctl database 7.3/5528
ATA Version is:   ACS-3 T13/2161-D revision 5
SATA Version is:  SATA 3.1, 6.0 Gb/s (current: 6.0 Gb/s)
Local Time is:    Thu Nov  9 08:21:36 2023 EST
SMART support is: Available - device has SMART capability.
SMART support is: Enabled
</code></pre>

<p>I got the following error because I&rsquo;m using a USB-C adapter:</p>

<pre><code class="language-none">smartctl 7.4 2023-08-01 r5530 [x86_64-linux-6.5.8-arch1-1] (local build)
Copyright (C) 2002-23, Bruce Allen, Christian Franke, www.smartmontools.org

/dev/sda: Unknown USB bridge [0x14b0:0x0200 (0x100)]
Please specify device type with the -d option.

Use smartctl -h to get a usage summary
</code></pre>

<p>If that&rsquo;s the same for you, you can try using it with <code>-d sat</code>, and if your adapter is supported it should work.</p>

<pre><code class="language-none">sudo smartctl -d sat -i /dev/sdX
</code></pre>

<p>Once we confirmed that the drive supports S.M.A.R.T. testing we can start. We are interested in the following three  tests:</p>

<ul>
<li><strong>Short</strong> - The goal of the short test is the rapid identification of a defective hard drive. Therefore, a maximum run time for the short test is 2 min</li>
<li><strong>Long</strong> - The long test was designed as the final test in production and is the same as the short test with two differences. The first: there is no time restriction and in the Read/Verify segment the entire disk is checked and not just a section</li>
<li><strong>Conveyance Test</strong> - This test can be performed to determine damage during transport of the hard disk within just a few minutes</li>
</ul>

<p>We specify the test using the <code>-t</code> flag:</p>

<pre><code class="language-none">smartctl -t [short|long|conveyance] [dev]
</code></pre>

<p>The test runs in the background and we can check it&rsquo;s status by greping <code>Self-test execution status</code>.</p>

<p>On the example below we can see that the test is in progress and that is 80% complete:</p>

<pre><code class="language-none">$ sudo smartctl -a /dev/sda | grep -A 1 'Self-test execution status:'
Self-test execution status:      ( 242)	Self-test routine in progress...
					20% of test remaining.
</code></pre>

<p>We can use the same command with to check the test result. Just change the <code>-A</code> to &lsquo;2&rsquo; in <code>grep</code>:</p>

<pre><code class="language-none">$ sudo smartctl -a /dev/sda | grep -A 2 'Self-test execution status:'
Self-test execution status:      (   0)	The previous self-test routine completed
					without error or no self-test has ever
					been run.
</code></pre>

<p>Another option is to use the <code>-l selftest</code> flag:</p>

<pre><code class="language-none">$ sudo smartctl -l selftest /dev/sda
smartctl 7.4 2023-08-01 r5530 [x86_64-linux-6.5.8-arch1-1] (local build)
Copyright (C) 2002-23, Bruce Allen, Christian Franke, www.smartmontools.org

=== START OF READ SMART DATA SECTION ===
SMART Self-test log structure revision number 1
Num  Test_Description    Status                  Remaining  LifeTime(hours)  LBA_of_first_error
# 1  Short offline       Completed without error       00%        20         -
</code></pre>

<p>Also check the following string after each test:</p>

<pre><code class="language-none">$ sudo smartctl -a /dev/sda | grep 'test result'
SMART overall-health self-assessment test result: PASSED
</code></pre>

<p>Now go ahead and run the short and conveyance tests (or all 3 if you have the time). Here&rsquo;s how long it took for me to run on a 6TB WD Red Plus (WD60EFPX) over USB-C (Nov 2023):</p>

<ul>
<li><em>conveyance</em> -1m13s</li>
<li><em>short</em> - 2m</li>
<li><em>long</em> - 11h20m</li>
</ul>

<p>If you have more than one hard drive to test, and you can plug them in at the same time, you can run the tests in parallel.</p>

<p>Once completed and you have confirmed they have passed, also check the thresholds at the end of the output. It will look similar to this:</p>

<pre><code class="language-none">Vendor Specific SMART Attributes with Thresholds:
ID# ATTRIBUTE_NAME          FLAG     VALUE WORST THRESH TYPE      UPDATED  WHEN_FAILED RAW_VALUE
  1 Raw_Read_Error_Rate     0x002f   200   200   051    Pre-fail  Always       -       0
  3 Spin_Up_Time            0x0027   100   253   021    Pre-fail  Always       -       0
  4 Start_Stop_Count        0x0032   100   100   000    Old_age   Always       -       2
  5 Reallocated_Sector_Ct   0x0033   200   200   140    Pre-fail  Always       -       0
  7 Seek_Error_Rate         0x002e   200   200   000    Old_age   Always       -       0
  9 Power_On_Hours          0x0032   100   100   000    Old_age   Always       -       46
 10 Spin_Retry_Count        0x0032   100   253   000    Old_age   Always       -       0
 11 Calibration_Retry_Count 0x0032   100   253   000    Old_age   Always       -       0
 12 Power_Cycle_Count       0x0032   100   100   000    Old_age   Always       -       1
192 Power-Off_Retract_Count 0x0032   200   200   000    Old_age   Always       -       0
193 Load_Cycle_Count        0x0032   200   200   000    Old_age   Always       -       3
194 Temperature_Celsius     0x0022   107   104   000    Old_age   Always       -       43
196 Reallocated_Event_Count 0x0032   200   200   000    Old_age   Always       -       0
197 Current_Pending_Sector  0x0032   200   200   000    Old_age   Always       -       0
198 Offline_Uncorrectable   0x0030   100   253   000    Old_age   Offline      -       0
199 UDMA_CRC_Error_Count    0x0032   200   200   000    Old_age   Always       -       0
200 Multi_Zone_Error_Rate   0x0008   100   253   000    Old_age   Offline      -       0
</code></pre>

<p>You want to pay attention to:</p>

<ul>
<li><code>Offline_Uncorrectable</code> - Damaged sectors that don&rsquo;t respond to any read/write requests (bad sectors). These sectors are remapped to spare sectors.</li>
<li><code>Reallocated_Sector_Ct</code> - Count of damaged sectors that were remapped to spare sectors.</li>
<li><code>Current_Pending_Sector</code> - Indicates the number of damaged sectors that are yet to be remapped or reallocated. This number could indicate that spare sectors are not available, and data from bad sectors can no longer be remapped.</li>
</ul>

<h2 id="badblocks">Badblocks</h2>

<p><img src="https://i.imgur.com/yPrwUU8m.png" alt="Imgur" /></p>

<p>Before we continue, let&rsquo;s just make sure that you are indeed testing a new set of spinning rust (a.k.a. hard drive), and <strong>not an SSD or an NVMe</strong>. We don&rsquo;t want to run <code>badblocks</code> on the later 2.</p>

<h3 id="overview">Overview</h3>

<blockquote>
<p><a href="https://wiki.archlinux.org/title/badblocks">Arch Wiki: badblocks</a></p>

<p>S.M.A.R.T. (Self-Monitoring, Analysis, and Reporting Technology) is featured in almost every HDD still in use nowadays, and in some cases it can automatically retire defective HDD sectors. However, S.M.A.R.T. only passively waits for errors while badblocks can actively write simple patterns to every block of a device and then check them, searching for damaged areas (Just like memtest86* does with RAM).</p>
</blockquote>

<p>Now that we have an understanding of what <code>badblocks</code> does, let&rsquo;s take some time to digest it. We will be writing to all blocks on your new hard drive and then reading to confirm that the data was written correctly. As if that wouldn&rsquo;t already take long, <code>badblocks</code> will do it not only once, but four times (with four different patterns).</p>

<blockquote>
<p><a href="https://wiki.archlinux.org/title/badblocks#Testing_for_bad_sectors">Arch Wiki</a></p>

<p>As the pattern is written to every accessible block, the device effectively gets wiped. The default is an extensive test with four passes using four different patterns: <code>0xaa</code> (10101010), <code>0x55</code> (01010101), <code>0xff</code> (11111111) and <code>0x00</code> (00000000). For some devices this will take a couple of days to complete.</p>
</blockquote>

<p>As with <code>smartctl</code>, you can run multiple instances of <code>badblocks</code> in parallel if you have multiple disks. You can also shorten the time of the test by increasing the number of blocks that are tested at time (<code>-c</code>), or by specifying a single pattern to be written with the <code>-t</code> option, e.g.: <code>-t '0xaa'</code>, which will force it to do only one pass. If you specify multiple patterns, e.g.: <code>-t '0xaa' -t '0x55'</code>, you will be essentially running multiple passes.</p>

<p>Another option is to use the random pattern option with <code>-t random</code>. This will make <code>badblocks</code> use random patterns for the test, with only one pass (unless you specify <code>-p</code>).</p>

<p>Just keep in mind that different patterns (used by the default write-mode) work better because you can validate against stuck bits. But based on the amount of drives, available drive buses, and time that you have, you might not actually be able to run the full test. But that&rsquo;s a decision that only you can make.</p>

<p>I wanted to time my tests to help you making a decision, but as I ran them over a USB-C adapter my badblocks seem to have maxed out at around 41mb/s:</p>

<blockquote>
<pre><code>  Total DISK READ :       0.00 B/s | Total DISK WRITE :      41.74 M/s
  Actual DISK READ:       0.00 B/s | Actual DISK WRITE:      41.74 M/s
       TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN     IO&gt;    COMMAND                                                          
  1516251 be/4 root        0.00 B/s   41.74 M/s  ?unavailable?  badblocks -wsvb 4096 -t 0x00 /dev/sda -o badblocks-output.log
</code></pre>
</blockquote>

<p>With that in mind, here are the timings from my latest test on a 6TB WD Red Plus (WD60EFPX) over USB-C (Nov 2023):</p>

<ul>
<li><em>Write mode</em> - 83h</li>
<li><em>Random write mode</em> - 81h</li>
<li><em>Write mode one pattern</em> - 80h</li>
</ul>

<p>And spoiler alert&hellip; we will be running the long test in <code>smartctl</code> once <code>badblocks</code> finishes. So also take that into account.</p>

<h3 id="running-the-test">Running the Test</h3>

<p>First, let&rsquo;s take a look at what your drive&rsquo;s recommended blocksize is:</p>

<pre><code class="language-none">sudo blockdev --getbsz /dev/sdX
</code></pre>

<p>Because this test will run for a while, start your preferred terminal multiplexer (e.g.: <code>screen</code>, <code>tmux</code>), change into root, and run <code>badblocks</code>:</p>

<pre><code class="language-none">time badblocks -wsvb {blocksize} /dev/sdX -o [output_file]
</code></pre>

<ul>
<li><code>time</code> a separate command to tell you the actual time <code>badblocks</code> ran for once complete.</li>
<li><code>-w</code> uses write-mode test, which is a <strong>destructive action</strong>.</li>
<li><code>-s</code> shows an estimate of the progress of the scan. This isn&rsquo;t 100% accurate, but it&rsquo;s better to see something than nothing at all.</li>
<li><code>-b {blocksize}</code> specify the block size. Be sure to replace <code>{blocksize}</code> with the number you found with the previous command mentioned (<code>blockdev --getbsz /dev/sdX</code>).</li>
<li><code>/dev/sdX</code> the drive you want to test. Replace with the actual drive. Be extra careful as you don&rsquo;t want to accidentally destroy data on the wrong disk.</li>
<li><code>-v</code> option is verbose mode</li>
<li><code>-o</code> option is output file. Without the <code>-o</code> <code>badblocks</code> will simply use the <code>STDOUT</code></li>
</ul>

<h2 id="s-m-a-r-t-again">S.M.A.R.T. Again</h2>

<p>Once the <code>badblocks</code> test is complete, run another long <code>smartctl</code> test and check to make sure that everything is still good.</p>

</div>


          <footer>
  
<span class="share-box">Share this on:
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.victormendonca.com%2f2023%2f11%2f21%2ftesting-new-hard-drives%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-facebook-official "></i></a>

    <a href="https://twitter.com/intent/tweet?text=Testing%20New%20Hard%20Drives&amp;url=https%3a%2f%2fblog.victormendonca.com%2f2023%2f11%2f21%2ftesting-new-hard-drives%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-twitter"></i></a>

    <a href="https://plus.google.com/share?url=https%3a%2f%2fblog.victormendonca.com%2f2023%2f11%2f21%2ftesting-new-hard-drives%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-google-plus"></i></a>

    <a href="http://www.reddit.com/submit?url=https%3a%2f%2fblog.victormendonca.com%2f2023%2f11%2f21%2ftesting-new-hard-drives%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-reddit"></i></a>

    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.victormendonca.com%2f2023%2f11%2f21%2ftesting-new-hard-drives%2f&amp;title=Testing%20New%20Hard%20Drives" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-linkedin"></i></a>

    <a href="mailto:?subject=Testing%20New%20Hard%20Drives&amp;body=Check out this site https%3a%2f%2fblog.victormendonca.com%2f2023%2f11%2f21%2ftesting-new-hard-drives%2f" data-proofer-ignore=""><i class="fa fa-envelope"></i></a>
  </span>

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
      
  
    <nav><ul class="pager">
    
        <li class="previous">
          <a href="https://blog.victormendonca.com/2023/07/20/how-to-migrate-local-users-and-grops/" title="How to Migrate Local Users and Grops">
            <span aria-hidden="true">&larr;</span>Previous
          </a>
        </li>
    

    
      <li class="next">
        <a href="https://blog.victormendonca.com/2023/11/27/rhce-v8-practiceexam/" title="RHCE v8 Practice Exam">
            Next <span aria-hidden="true">&rarr;</span>
        </a>
      </li>
    
    </ul> </nav>
  


</div>

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
  

</div>

</footer>

        
          <div>
  <h2><a href="https://blog.victormendonca.com/2023/07/20/how-to-migrate-local-users-and-grops/">How to Migrate Local Users and Grops</a>
</h2>

  <div class="margin-10">
    <small>
  <i class="fa fa-calendar"></i>
  <time datetime="2023-07-20">20 Jul, 2023</time>
</small>

    
  <i class="fa fa-tags"></i>
  
  <a href="https://blog.victormendonca.com/tags/bash" class="label label-primary">Bash</a>
  
  <a href="https://blog.victormendonca.com/tags/linux" class="label label-primary">Linux</a>
  


  </div>
</div>

          <div class="content">
  

<h3 id="introduction">Introduction</h3>

<p>Migrating users from one Linux system to another can be a complex task, but with the right steps and careful planning, it can be accomplished smoothly. In this guide, we will walk you through the process of migrating users, their passwords, groups, and home folders from one Linux system to another. We&rsquo;ll be using bash scripts to automate the backup and restore process, ensuring a seamless transition.</p>

<p>The following items will not be covered by our instructions:</p>

<ul>
<li>User limits</li>
<li>Mail</li>
<li>Group password</li>
</ul>

<h3 id="step-1-backup-user-information-on-the-source-server">Step 1: Backup User Information on the Source Server</h3>

<p>First, log in to the source Linux system and open a terminal. Use the following command to get a list of all users:</p>

<pre><code class="language-bash">lslogins -o &quot;USER,UID,GECOS,HOMEDIR,SHELL,GROUP,GID,SUPP-GROUPS,SUPP-GIDS&quot;
</code></pre>

<p>Next, identify the users you want to migrate and add their names to the <code>users_to_backup</code> variable in the provided script:</p>

<pre><code class="language-bash">backup_password_file=&quot;etc-passwd-bak&quot;
backup_group_file=&quot;etc-group-bak&quot;
backup_shadow_file=&quot;etc-shadow-bak&quot;
# Add more users separated by spaces if needed
users_to_backup=&quot;linus lennart&quot;

for user in $users_to_backup ; do
  curuser=$user
  echo -e &quot;\n=&gt; User is $curuser&quot;
  curid=$(id -u &quot;$curuser&quot;)
  curgid=$(id -g &quot;$curuser&quot;)
  cursupgit=$(id -G &quot;$curuser&quot;)
  echo &quot;User id is $curid&quot;
  echo &quot;User group id is $curgid&quot;
  echo &quot;User supplementary groups are $cursupgit&quot;
  echo &quot;Backing up /etc/passwd for $curuser&quot;
  grep -E &quot;^${curuser}:.:${curid}&quot; /etc/passwd &gt;&gt; &quot;$backup_password_file&quot;

  echo &quot;Backing up primary group for $curuser&quot;
  if [ -f &quot;$backup_group_file&quot; ] ; then
    if grep -q &quot;:${curid}:&quot; &quot;$backup_group_file&quot; ; then
      echo &quot;Group already backed up&quot;
    else
      grep &quot;:${curid}:&quot; /etc/group &gt;&gt; &quot;$backup_group_file&quot;
    fi
  else
    grep &quot;:${curid}:&quot; /etc/group &gt;&gt; &quot;$backup_group_file&quot;
  fi

  echo &quot;Backing up secondary groups for $curuser&quot;
  for groupid in $cursupgit ; do
    if grep -q &quot;:${groupid}:&quot; &quot;$backup_group_file&quot; ; then
      echo &quot;Group already backed up&quot;
    else
      grep &quot;:${groupid}:&quot; /etc/group &gt;&gt; &quot;$backup_group_file&quot;
    fi
  done

  echo &quot;Backing up /etc/shadow for $curuser&quot;
  sudo grep -E &quot;^$curuser&quot; /etc/shadow &gt;&gt; &quot;$backup_shadow_file&quot;
done
</code></pre>

<p>Save the script to a file, e.g., <code>user_backup_script.sh</code>, and make it executable:</p>

<pre><code class="language-bash">chmod +x user_backup_script.sh
</code></pre>

<p>Execute the script as root:</p>

<pre><code class="language-bash">sudo ./user_backup_script.sh
</code></pre>

<p>The script will back up user information, including passwords and group data, to the specified backup files.</p>

<h3 id="step-2-copy-backup-files-to-the-destination-server">Step 2: Copy Backup Files to the Destination Server</h3>

<p>Next, copy the three backup files (<em>etc-passwd-bak</em>, <em>etc-group-bak</em>, and <em>etc-shadow-bak</em>) from the source server to the destination server using the scp command or any preferred method.</p>

<pre><code class="language-bash"># Example using scp
scp etc-*-bak user@destination_server:/path/to/backup_files/
</code></pre>

<h3 id="step-3-restore-users-on-the-destination-server">Step 3: Restore Users on the Destination Server</h3>

<p>Log in to the destination Linux system and open a terminal. Navigate to the directory where the backup files are located and run the provided restore script as root:</p>

<pre><code class="language-bash">backup_password_file=&quot;etc-passwd-bak&quot;
backup_group_file=&quot;etc-group-bak&quot;
backup_shadow_file=&quot;etc-shadow-bak&quot;

echo -e &quot;\n=&gt; Backing up the system files&quot;
for file in /etc/{passwd,group,shadow} ; do
  cp -v &quot;$file&quot; &quot;${file}_$(date -I)&quot;
done

echo -e &quot;\n=&gt; Restoring users&quot;
cat &quot;$backup_password_file&quot; | while read -r line ; do
  userid=&quot;$(echo &quot;$line&quot; | awk -F&quot;:&quot; '{print $3}')&quot;
  username=&quot;$(echo &quot;$line&quot; | awk -F&quot;:&quot; '{print $1}')&quot;
  echo &quot;-&gt; Restoring user $username&quot;
  if grep -Eq &quot;^${username}:.:${userid}&quot; /etc/passwd ; then
    echo &quot;  ERROR: User ID already exists. Manual intervention is needed&quot;
  else
    echo &quot;$line&quot; &gt;&gt; /etc/passwd
    if grep -qE &quot;^${username}:&quot; /etc/shadow ; then
      echo &quot;  ERROR: User password already exists. Manual intervention is needed&quot;
    else
      grep -E &quot;^${username}:&quot; &quot;$backup_shadow_file&quot; &gt;&gt; /etc/shadow
    fi
  fi
done

echo -e &quot;\n=&gt; Restoring groups&quot;
cat &quot;$backup_group_file&quot; | while read -r line ; do
  groupid=&quot;$(echo &quot;$line&quot; | awk -F&quot;:&quot; '{print $3}')&quot;
  groupname=&quot;$(echo &quot;$line&quot; | awk -F&quot;:&quot; '{print $1}')&quot;
  echo &quot;-&gt; Restoring group $groupname&quot;
  if grep -qE &quot;^${groupname}:.:${groupid}&quot; /etc/group ; then
    echo &quot;  ERROR: Group already exists. Manual intervention may be needed&quot;
  else
    echo &quot;$line&quot; &gt;&gt; /etc/group
  fi
done
</code></pre>

<p>Run the restore script:</p>

<pre><code class="language-bash">sudo ./user_restore_script.sh
</code></pre>

<p>The script will restore the users and their passwords, taking care to avoid conflicts with existing user IDs. Pay close attention to error messages and take action if needed. If there are any error messages related to system group creation, it might be acceptable as the groups may already exist on the new system.</p>

<h3 id="step-4-copy-home-folders-and-set-permissions">Step 4: Copy Home Folders and Set Permissions</h3>

<p>Finally, to complete the migration, copy the home folders for the desired users from the source server to the destination server using rsync:</p>

<pre><code class="language-bash"># Replace 'user1,user2,user3' with appropriate values
# Replace 'destination_server' with appropriate values
rsync -avzh -e ssh /home/{user1,user2,user3} user@destination_server:/home/
</code></pre>

<p>Ensure that the permissions and ownership are set correctly for the home folder of each user on the destination server:</p>

<pre><code class="language-bash"># Replace user and primary_group with appropriate values
sudo chown -R user:primary_group /home/user
</code></pre>

<p><strong>Note:</strong> <em>For SFTP users that use CHROOT, the user&rsquo;s home folder needs to be owned by &lsquo;root&rsquo;</em></p>

<h3 id="conclusion">Conclusion:</h3>

<p>Migrating users from one Linux system to another involves a series of crucial steps, including backup, restoration, and copying of home folders. By using the provided scripts and following this step-by-step guide, you can ensure a smooth and successful user migration process. Always exercise caution during the migration and verify the results to ensure everything is functioning as expected on the destination system.</p>

<p><strong>Additional reading:</strong></p>

<ul>
<li><a href="https://access.redhat.com/solutions/179753">https://access.redhat.com/solutions/179753</a></li>
</ul>

</div>


          <footer>
  
<span class="share-box">Share this on:
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.victormendonca.com%2f2023%2f07%2f20%2fhow-to-migrate-local-users-and-grops%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-facebook-official "></i></a>

    <a href="https://twitter.com/intent/tweet?text=How%20to%20Migrate%20Local%20Users%20and%20Grops&amp;url=https%3a%2f%2fblog.victormendonca.com%2f2023%2f07%2f20%2fhow-to-migrate-local-users-and-grops%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-twitter"></i></a>

    <a href="https://plus.google.com/share?url=https%3a%2f%2fblog.victormendonca.com%2f2023%2f07%2f20%2fhow-to-migrate-local-users-and-grops%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-google-plus"></i></a>

    <a href="http://www.reddit.com/submit?url=https%3a%2f%2fblog.victormendonca.com%2f2023%2f07%2f20%2fhow-to-migrate-local-users-and-grops%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-reddit"></i></a>

    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.victormendonca.com%2f2023%2f07%2f20%2fhow-to-migrate-local-users-and-grops%2f&amp;title=How%20to%20Migrate%20Local%20Users%20and%20Grops" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-linkedin"></i></a>

    <a href="mailto:?subject=How%20to%20Migrate%20Local%20Users%20and%20Grops&amp;body=Check out this site https%3a%2f%2fblog.victormendonca.com%2f2023%2f07%2f20%2fhow-to-migrate-local-users-and-grops%2f" data-proofer-ignore=""><i class="fa fa-envelope"></i></a>
  </span>

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
      
  
    <nav><ul class="pager">
    
        <li class="previous">
          <a href="https://blog.victormendonca.com/2023/06/30/undestanting-yum-clean-all-and-stale-repos/" title="Understanding &#34;yum clean all&#34; and Stale Repos">
            <span aria-hidden="true">&larr;</span>Previous
          </a>
        </li>
    

    
      <li class="next">
        <a href="https://blog.victormendonca.com/2023/11/21/testing-new-hard-drives/" title="Testing New Hard Drives">
            Next <span aria-hidden="true">&rarr;</span>
        </a>
      </li>
    
    </ul> </nav>
  


</div>

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
  

</div>

</footer>

        
          <div>
  <h2><a href="https://blog.victormendonca.com/2023/06/30/undestanting-yum-clean-all-and-stale-repos/">Understanding &#34;yum clean all&#34; and Stale Repos</a>
</h2>

  <div class="margin-10">
    <small>
  <i class="fa fa-calendar"></i>
  <time datetime="2023-06-30">30 Jun, 2023</time>
</small>

    
  <i class="fa fa-tags"></i>
  
  <a href="https://blog.victormendonca.com/tags/linux" class="label label-primary">Linux</a>
  
  <a href="https://blog.victormendonca.com/tags/redhat" class="label label-primary">RedHat</a>
  


  </div>
</div>

          <div class="content">
  

<p>When it comes to managing packages on a Linux system, the YUM (<a href="https://linux.die.net/man/8/yum">Yellowdog Updater Modified</a>) package manager is widely used for its ease of use and robust features. One of the handy commands in YUM is <code>yum clean all</code>, which helps you keep your system clean and optimized. In this blog post, we will delve into the functionalities of <code>yum clean all</code> and explore how it can help you clear accumulated cache and improve system performance.</p>

<h3 id="cleaning-options">Cleaning Options</h3>

<p>The <code>yum clean</code> command can be used with specific options to clean individual components. Here are some of the available options:</p>

<ul>
<li><strong>packages:</strong> Cleans package-related cache files</li>
<li><strong>metadata:</strong> Removes metadata and other files related to enabled repositories</li>
<li><strong>expire-cache:</strong> Cleans the cache for metadata that has expired</li>
<li><strong>rpmdb:</strong> Cleans the YUM database cache</li>
<li><strong>plugins:</strong> Clears any cache maintained by YUM plugins</li>
<li><strong>all:</strong> Performs a comprehensive cleaning, covering all the above options</li>
</ul>

<h3 id="clean-everything">Clean Everything</h3>

<p>The <code>yum clean all</code> command serves as a one-stop solution to clean various elements that accumulate in the YUM cache directory over time. It offers several cleaning options, allowing you to target specific items or perform a comprehensive clean.</p>

<p>It&rsquo;s essential to note that <code>yum clean all</code> does not clean untracked &ldquo;stale&rdquo; repositories. This means that if a repository is no longer in use or has been disabled, its cache will not be cleared by this command. We&rsquo;ll explore an alternative method to handle untracked repositories shortly.</p>

<h4 id="analyzing-cache-usage">Analyzing Cache Usage</h4>

<p>Before diving into the cleaning process, it&rsquo;s helpful to analyze the cache usage on your system. You can use the following command to check the cache usage:</p>

<pre><code class="language-bash">$ df -hT /var/cache/yum/

Filesystem               Type  Size  Used Avail Use% Mounted on
/dev/mapper/rootvg-varlv xfs   8.0G  4.6G  3.5G  57% /var
</code></pre>

<h4 id="cleaning-with-yum-clean-all">Cleaning with &lsquo;yum clean all&rsquo;</h4>

<p>When you execute <code>yum clean all</code>, the command will remove various cached files and improve system performance. However, you may sometimes notice a warning regarding other repository data:</p>

<pre><code>Other repos take up 1.1 G of disk space (use --verbose for details)
</code></pre>

<p>If you run it with the <code>--verbose</code> flag, you should see a list of stale/untracked repos</p>

<pre><code class="language-bash">$ sudo yum clean all --verbose

Not loading &quot;rhnplugin&quot; plugin, as it is disabled
Loading &quot;langpacks&quot; plugin
Loading &quot;product-id&quot; plugin
Loading &quot;search-disabled-repos&quot; plugin
Not loading &quot;subscription-manager&quot; plugin, as it is disabled
Adding en_US.UTF-8 to language list
Config time: 0.110
Yum version: 3.4.3
Cleaning repos: epel rhel-7-server-ansible-2-rhui-rpms rhel-7-server-rhui-extras-rpms rhel-7-server-rhui-optional-rpms rhel-7-server-rhui-rh-common-rpms rhel-7-server-rhui-rpms
              : rhel-7-server-rhui-supplementary-rpms rhel-server-rhui-rhscl-7-rpms rhui-microsoft-azure-rhel7
Operating on /var/cache/yum/x86_64/7Server (see CLEAN OPTIONS in yum(8) for details)
Disk usage under /var/cache/yum/*/* after cleanup:
0      enabled repos
0      disabled repos
1.1 G  untracked repos:
  1.0 G  /var/cache/yum/x86_64/7Server/rhui-rhel-7-server-rhui-rpms
  90 M   /var/cache/yum/x86_64/7Server/rhui-rhel-server-rhui-rhscl-7-rpms
  9.8 M  /var/cache/yum/x86_64/7Server/rhui-rhel-7-server-rhui-extras-rpms
  6.4 M  /var/cache/yum/x86_64/7Server/rhui-rhel-7-server-rhui-supplementary-rpms
  5.3 M  /var/cache/yum/x86_64/7Server/rhui-rhel-7-server-dotnet-rhui-rpms
  1.6 M  /var/cache/yum/x86_64/7Server/rhui-rhel-7-server-rhui-rh-common-rpms
4.0 k  other data:
  4.0 k  /var/cache/yum/x86_64/7Serve
</code></pre>

<h4 id="manually-removing-untracked-repository-files">Manually Removing Untracked Repository Files</h4>

<p>To handle untracked repository files, you can manually remove them from the cache directory with <code>rm</code>:</p>

<pre><code class="language-bash">$ sudo rm -rf /var/cache/yum/*
</code></pre>

<h4 id="refreshing-the-cache">Refreshing the Cache</h4>

<p>Next time you run commands like <code>yum check-update</code> or any other operation that refreshes the cache, YUM will rebuild the package list and recreate the cache directory for the enabled repositories.</p>

<h4 id="check-the-cache-usage-after-cleanup">Check the Cache Usage After Cleanup</h4>

<p>After performing the cleanup, you can verify the reduced cache usage. Use the <code>df</code> command again to check the cache size:</p>

<pre><code class="language-bash">$ df -hT /var/cache/yum/
</code></pre>

<h3 id="doing-it-all-with-ansible">Doing it all with Ansible</h3>

<p>And if you want to, you can use the Ansible playbook below to automate the YUM cache purge and re-creation:</p>

<pre><code class="language-yaml">---
- name: Delete yum cache and run yum check-update
  # Add your hosts accordingly below
  hosts: webserver
  become: yes
  tasks:

    - name: Check /var usage with df command
      shell: |
        df -hT /var | awk '{print $6}' | tail -1 | tr -d '%'
      register: var_usage_output

    - name: Display /var usage information
      debug:
        var: var_usage_output.stdout

    ##-- Block starts --------------------------------------------------------------
    - when: var_usage_output.stdout|int &gt; 55
      block:

      - name: Delete yum cache directory
        file:
          path: /var/cache/yum
          state: absent

      - name: Update YUM cache
        yum:
          name: ''
          update_cache: yes

      - name: Check /var usage with df command
        shell: |
          df -hT /var | awk '{print $6}' | tail -1
        register: var_usage_after_cleanup_output

      - name: Display /var usage information
        debug:
          var: var_usage_after_cleanup_output.stdout
    ##-- block ends ----------------------------------------------------------------
</code></pre>

<h3 id="conclusion">Conclusion</h3>

<p>Regularly cleaning the YUM cache with the <code>yum clean all</code> command can help optimize your system&rsquo;s performance by clearing accumulated files. By understanding the available cleaning options and handling untracked repositories, you can ensure that your YUM cache remains streamlined and efficient. Keep your system running smoothly and enjoy the benefits of a clean YUM cache!</p>

<p>Remember, maintaining a clean and optimized system contributes to a seamless Linux experience.</p>

</div>


          <footer>
  
<span class="share-box">Share this on:
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.victormendonca.com%2f2023%2f06%2f30%2fundestanting-yum-clean-all-and-stale-repos%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-facebook-official "></i></a>

    <a href="https://twitter.com/intent/tweet?text=Understanding%20%22yum%20clean%20all%22%20and%20Stale%20Repos&amp;url=https%3a%2f%2fblog.victormendonca.com%2f2023%2f06%2f30%2fundestanting-yum-clean-all-and-stale-repos%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-twitter"></i></a>

    <a href="https://plus.google.com/share?url=https%3a%2f%2fblog.victormendonca.com%2f2023%2f06%2f30%2fundestanting-yum-clean-all-and-stale-repos%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-google-plus"></i></a>

    <a href="http://www.reddit.com/submit?url=https%3a%2f%2fblog.victormendonca.com%2f2023%2f06%2f30%2fundestanting-yum-clean-all-and-stale-repos%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-reddit"></i></a>

    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.victormendonca.com%2f2023%2f06%2f30%2fundestanting-yum-clean-all-and-stale-repos%2f&amp;title=Understanding%20%22yum%20clean%20all%22%20and%20Stale%20Repos" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-linkedin"></i></a>

    <a href="mailto:?subject=Understanding%20%22yum%20clean%20all%22%20and%20Stale%20Repos&amp;body=Check out this site https%3a%2f%2fblog.victormendonca.com%2f2023%2f06%2f30%2fundestanting-yum-clean-all-and-stale-repos%2f" data-proofer-ignore=""><i class="fa fa-envelope"></i></a>
  </span>

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
      
  
    <nav><ul class="pager">
    
        <li class="previous">
          <a href="https://blog.victormendonca.com/2022/11/18/linux-find-command/" title="Linux find Command">
            <span aria-hidden="true">&larr;</span>Previous
          </a>
        </li>
    

    
      <li class="next">
        <a href="https://blog.victormendonca.com/2023/07/20/how-to-migrate-local-users-and-grops/" title="How to Migrate Local Users and Grops">
            Next <span aria-hidden="true">&rarr;</span>
        </a>
      </li>
    
    </ul> </nav>
  


</div>

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
  

</div>

</footer>

        
          <div>
  <h2><a href="https://blog.victormendonca.com/2022/11/18/linux-find-command/">Linux find Command</a>
</h2>

  <div class="margin-10">
    <small>
  <i class="fa fa-calendar"></i>
  <time datetime="2022-11-18">18 Nov, 2022</time>
</small>

    
  <i class="fa fa-tags"></i>
  
  <a href="https://blog.victormendonca.com/tags/linux" class="label label-primary">Linux</a>
  
  <a href="https://blog.victormendonca.com/tags/bash" class="label label-primary">bash</a>
  


  </div>
</div>

          <div class="content">
  

<p>The Linux <code>find</code> command is a very versatile tool in the pocket of any Linux administrator. It allows you to quickly search for files and take action based on the results.</p>

<p>The basic construct of the command is:</p>

<pre><code>find [options] [path] [expression]
</code></pre>

<p>The <code>options</code> part of the command controls some basic functionality for <code>find</code> and I&rsquo;m not going to cover it here. I will instead quickly look at the components for the expression part of the command, and provide some useful examples.</p>

<p>Expressions are composed of tests, actions, global options, positional options and operators:</p>

<ul>
<li><strong>Test</strong> - returns true or false (e.g.: <code>-mtime</code>, <code>-name</code>, <code>-size</code>)</li>
<li><strong>Actions</strong> - Acts on something (e.g.: <code>-exec</code>, <code>-delete</code>)</li>
<li><strong>Global options</strong> - Affect the operations of tests and actions (e.g.:<code>-depth</code>, <code>-maxdepth</code>,)</li>
<li><strong>Positional options</strong> - Modifies tests and actions (e.g.: <code>-follow</code>, <code>-regextype</code>)</li>
<li><strong>Operators</strong> - Include, join and modify items (e.g.: <code>-a</code>, <code>-o</code>)</li>
</ul>

<h2 id="operators">Operators</h2>

<p>Operators are the logical <code>OR</code> and <code>AND</code> of find, as well as negation and expression grouping.</p>

<table>
<thead>
<tr>
<th>Operator</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td><code>\( expr \)</code></td>
<td>Force precedence</td>
</tr>

<tr>
<td><code>!</code> or <code>-not</code></td>
<td>Negate</td>
</tr>

<tr>
<td><code>-a</code> or <code>-and</code></td>
<td>Logical <code>AND</code>. If two expressions are given without <code>-a</code> find will take it as implied. expr2 is not evaluated if expr1 is false</td>
</tr>

<tr>
<td><code>-o</code> of <code>-or</code></td>
<td>Logical <code>OR</code>. expr2 is not evaluated if expr1 is true</td>
</tr>

<tr>
<td><code>,</code></td>
<td>Both  expr1  and expr2 are always evaluated.  The value of expr1 is discarded</td>
</tr>
</tbody>
</table>

<p>You can use the operators for repeated search options with different values.</p>

<p><em><strong>Example 1:</strong> Find files with multiple file extensions</em></p>

<pre><code class="language-bash">find ${jboss_dplymnt_dir} -type f -size -2k \( \
  -name '*.deployed' -o -name '*.dodeploy' \
  -o -name '*.skipdeploy' -o -name '*.isdeploying' \
  -o -name '*.failed' -o -name '*.isundeploying' \
  -o -name '*.pending' -o -name '*.undeployed' \
\)
</code></pre>

<p><em><strong>Example 2:</strong> find MOV or MP4 files that do not have &lsquo;h265&rsquo; in the file name</em></p>

<pre><code class="language-bash">find . \( \
  ! -name '*h265*' -a \( \
    -name '*.mp4' -o -name '*.MP4' \
    -o -name '*.mov' -o -name '*.MOV' \
  \) \
\)
</code></pre>

<p>Or to negate search options.</p>

<p><em><strong>Example 3:</strong> find files that don&rsquo;t finish with the &lsquo;.log&rsquo; extension</em></p>

<pre><code class="language-bash">find . -type f -not -name '*.log'
</code></pre>

<p><em><strong>Example 4:</strong> Excludes everything in the folder named &lsquo;directory&rsquo;</em></p>

<pre><code class="language-bash">find -name &quot;*.js&quot; -not -path &quot;./directory/*&quot;
</code></pre>

<h2 id="global-options">Global Options</h2>

<p>Two very useful global options are <code>-maxdepth</code> and <code>-mindepth</code>.</p>

<ul>
<li><strong>maxdepth levels</strong>: Descend at most levels (a non-negative integer) levels of directories below the starting-points. <code>-maxdepth 0</code> means only apply the tests and actions to the starting-points themselves.</li>
<li><strong>mindepth levels</strong>: Do not apply any tests or actions at levels less than levels (a non-negative integer). <code>-mindepth 1</code> means process all files except the starting-points.</li>
</ul>

<p><em><strong>Example 5:</strong> find all files with &lsquo;.txt&rsquo; extension on the current dir and <strong>do not descend into subdirectories</strong></em></p>

<pre><code class="language-bash">find . -maxdepth 1 -name '*.txt'
</code></pre>

<h2 id="tests">Tests</h2>

<p>This is where you can target specific properties about the files that you are searching for. Some of my preferred tests are:</p>

<ul>
<li><code>-iname</code> - Like <code>-name</code>, but the match is case insensitive</li>
<li><code>-size</code> - Matches based on size (e.g.: <code>-size -2k</code>, <code>-size +1G</code>)</li>
<li><code>-user</code> - File Belongs to username</li>
<li><code>-newer</code> - File is newer than file. It can be a powerful option</li>
</ul>

<p><em><strong>Example 6:</strong> Find files for user</em></p>

<pre><code class="language-bash">find . -type f -user linustorvalds
</code></pre>

<p><em><strong>Example 7:</strong> Find files larger than 1GB</em></p>

<pre><code class="language-bash">find . -type f -size +1G
</code></pre>

<p><em><strong>Example 8:</strong> Here&rsquo;s a hidden gem! Let&rsquo;s say you need to find what files a program is creating. All you need to do is create a file, run the program, and then use <code>-newer</code> to find what files were created</em></p>

<pre><code class="language-bash"># Create a file
touch file_marker

# Here I run the script or program
./my_script.sh

# Now I can use the file I created to find newer files that were created by the script
find . -type f -newer 'file_marker'
</code></pre>

<h2 id="actions">Actions</h2>

<p>Actions will execute the specified action against the matched filenames. Some useful actions are:</p>

<ul>
<li><code>-ls</code> - Lists matched files with <code>ls -dils</code></li>
<li><code>-delete</code> - Deletes the matched files</li>
<li><code>-exec</code> - Execute the specified command against the files</li>
<li><code>-ok</code> - Prompts user for before executing command</li>
<li><code>-print0</code> - Prints the full name of the matched files followed by a null character</li>
</ul>

<h2 id="real-life-scenarios">Real-life Scenarios</h2>

<h4 id="get-a-confirmation-prompt">Get a confirmation prompt</h4>

<p>Use <code>-ok</code> to get a confirmation prompt before executing the action on the matched files.</p>

<pre><code class="language-bash">find . -type f -name '*.txt' -ok rm -rf {} \;
&lt; rm ... ./file_10.txt &gt; ? y
&lt; rm ... ./file_9.txt &gt; ? y
&lt; rm ... ./file_8.txt &gt; ?
</code></pre>

<h4 id="deleting-files">Deleting files</h4>

<p>Whenever possible, use <code>-delete</code> instead of <code>-exec rm -rf {} \;</code>.</p>

<pre><code class="language-bash">find . -type f -name &quot;*.bak&quot; -exec rm -f {} \;
</code></pre>

<p>Instead use:</p>

<pre><code class="language-bash">find . -type f -name &quot;*.bak&quot; -delete
</code></pre>

<h4 id="using-xargs-and">Using <code>xargs</code> and <code>{} +</code></h4>

<p>The command bellow will run into a problem if files or directories with embedded spaces in their names are encountered. <code>xargs</code> will treat each part of that name as a separate argument:</p>

<pre><code class="language-bash">find /usr/include -name &quot;*.h&quot; -type f | xargs grep &quot;#define UINT&quot;
</code></pre>

<p>There are two ways to avoid that. You could tell both <code>find</code> and <code>xargs</code> to use a <code>NUL</code> character as a separator:</p>

<pre><code class="language-bash">find /usr/include -name &quot;*.h&quot; -type f -print0 | xargs -0 grep &quot;#define UINT&quot;
</code></pre>

<p>Or, you could avoid use of <code>xargs</code> altogether and let <code>find</code> invoke <code>grep</code> directly:</p>

<pre><code class="language-bash">find /usr/include -name &quot;*.h&quot; -type f -exec grep &quot;#define UINT&quot; {} +
</code></pre>

<p>That final <code>+</code> tells <code>find</code> that <code>grep</code> will accept multiple file name arguments. Like <code>xargs</code>, <code>find</code> will put as many names as possible into each invocation of <code>grep</code>.</p>

<h4 id="find-and-move">Find and Move</h4>

<p>Find files and move them to a different location.</p>

<ul>
<li><code>-v</code> - For verbose</li>
<li><code>-t</code> - Move all <code>SOURCE</code> arguments into <code>DIRECTORY</code></li>
<li><code>-exec command {} +</code> - As we saw before, this variant of the <code>-exec</code> action runs the specified command on the selected files, but the command line is built by appending each selected file name at the end; the total number of invocations of the command will be much less than the number of matched files</li>
</ul>

<p>No need for <code>\;</code> at the end.</p>

<pre><code class="language-bash">find . -maxdepth 1 -name 'sa-*' -exec mv -v -t rsa-todelete/ {} +
</code></pre>

<h4 id="search-pdf-content">Search PDF content</h4>

<p>Here we search the contents of PDF files for specif text. Two options are shown below, each require the install of an additional package (<code>pdfgrep</code> and <code>ripgrep-all</code>).</p>

<p>With <code>pdfgrep</code>:</p>

<pre><code class="language-bash">find . -iname '*.pdf' -exec pdfgrep [pattern] {} +
</code></pre>

<p>With <code>ripgrep-all</code>:</p>

<pre><code class="language-bash">find . -iname '*.pdf' | xargs rga -H PURGE_TRAN_LOG.sh
</code></pre>

<h4 id="check-if-files-exists">Check if files exists</h4>

<p>One of the problems with <code>find</code> is that it doesn&rsquo;t return <code>true</code> or <code>false</code> based on search results. But we can still use it on our <code>if</code> condition by greping the result.</p>

<pre><code class="language-bash">if find /var/log -name '*.log' | grep -q log ; then
  echo &quot;File exists&quot;
fi
</code></pre>

<h3 id="conclusion">Conclusion</h3>

<p>You should now have a better understanding of the <code>find</code> command, as well as some nifty use cases to impress you co-workers.</p>

<p>If you found something useful or want to share an interesting use for <code>find</code>, please leave a comment below.</p>

</div>


          <footer>
  
<span class="share-box">Share this on:
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.victormendonca.com%2f2022%2f11%2f18%2flinux-find-command%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-facebook-official "></i></a>

    <a href="https://twitter.com/intent/tweet?text=Linux%20find%20Command&amp;url=https%3a%2f%2fblog.victormendonca.com%2f2022%2f11%2f18%2flinux-find-command%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-twitter"></i></a>

    <a href="https://plus.google.com/share?url=https%3a%2f%2fblog.victormendonca.com%2f2022%2f11%2f18%2flinux-find-command%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-google-plus"></i></a>

    <a href="http://www.reddit.com/submit?url=https%3a%2f%2fblog.victormendonca.com%2f2022%2f11%2f18%2flinux-find-command%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-reddit"></i></a>

    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.victormendonca.com%2f2022%2f11%2f18%2flinux-find-command%2f&amp;title=Linux%20find%20Command" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-linkedin"></i></a>

    <a href="mailto:?subject=Linux%20find%20Command&amp;body=Check out this site https%3a%2f%2fblog.victormendonca.com%2f2022%2f11%2f18%2flinux-find-command%2f" data-proofer-ignore=""><i class="fa fa-envelope"></i></a>
  </span>

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
      
  
    <nav><ul class="pager">
    
        <li class="previous">
          <a href="https://blog.victormendonca.com/2021/02/28/getting-started-with-ansible-molecule/" title="Getting Started with Ansible Molecule">
            <span aria-hidden="true">&larr;</span>Previous
          </a>
        </li>
    

    
      <li class="next">
        <a href="https://blog.victormendonca.com/2023/06/30/undestanting-yum-clean-all-and-stale-repos/" title="Understanding &#34;yum clean all&#34; and Stale Repos">
            Next <span aria-hidden="true">&rarr;</span>
        </a>
      </li>
    
    </ul> </nav>
  


</div>

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
  

</div>

</footer>

        
          <div>
  <h2><a href="https://blog.victormendonca.com/2021/02/28/getting-started-with-ansible-molecule/">Getting Started with Ansible Molecule</a>
</h2>

  <div class="margin-10">
    <small>
  <i class="fa fa-calendar"></i>
  <time datetime="2021-02-28">28 Feb, 2021</time>
</small>

    
  <i class="fa fa-tags"></i>
  
  <a href="https://blog.victormendonca.com/tags/linux" class="label label-primary">Linux</a>
  
  <a href="https://blog.victormendonca.com/tags/ansible" class="label label-primary">Ansible</a>
  
  <a href="https://blog.victormendonca.com/tags/docker" class="label label-primary">Docker</a>
  


  </div>
</div>

          <div class="content">
  

<h2 id="overview">Overview</h2>

<p>If you haven&rsquo;t heard about Ansible Molecule you came to the right place. I will cover what it is, it&rsquo;s basic usage, and how to install it and get started.</p>

<h4 id="what-it-is">What it is</h4>

<p><a href="https://molecule.readthedocs.io/en/latest/">Ansible Molecule</a> is a project (tool) that can greatly improve your Ansible workflow. It allows you to automate your tasks (which is great for CI) by providing means of running different and idempotent tests against your roles.</p>

<p>And Molecule is based on Ansible, so you are essentially using Ansible to test Ansible. How cool is that!?</p>

<h4 id="what-it-does">What it does</h4>

<p>To put it in simple words, Molecule tests your code. With Molecule you can easily run multiple tests against your code and make sure it works before deploying to an environment.</p>

<p>Some of the tests you can run are:</p>

<ul>
<li>Yaml lint</li>
<li>Ansible lint</li>
<li>Ansible syntax</li>
<li>Run the Ansible role against a virtual machine</li>
<li>Test idempotence (run the same Ansible role against the same virtual machine for the second time)</li>
</ul>

<h4 id="folder-structure">Folder Structure</h4>

<p>When invoked Molecule creates a single role folder with the usual Ansible structure. Inside this role folder an additional <code>molecule</code> folder is created. This is where the main Molecule configuration lives.</p>

<pre><code class="language-none">$ tree -d
.
 defaults
 files
 handlers
 molecule
    default
        converge.yml
        molecule.yml
        verify.yml
 tasks
 templates
 tests
 vars
</code></pre>

<h4 id="test-types-and-scenarios">Test Types and Scenarios</h4>

<p>Test scenarios can be configured inside the molecule folder and each scenario should have it&rsquo;s own folder.</p>

<p>A &lsquo;default&rsquo; scenario is created automatically with the following tests enabled (you can change them according to your needs):</p>

<ul>
<li>lint</li>
<li>destroy</li>
<li>dependency</li>
<li>syntax</li>
<li>create</li>
<li>prepare</li>
<li>converge</li>
<li>idempotence</li>
<li>side_effect</li>
<li>verify</li>
<li>destroy</li>
</ul>

<h4 id="drivers">Drivers</h4>

<p>Three different drivers (Vagrant, Docker, and OpenStack) can be used to create virtual machines. These virtual machines are used to test our roles.</p>

<p><em>On this tutorial we will be using Docker as our driver.</em></p>

<h2 id="installing-molecule">Installing Molecule</h2>

<p>Molecule can be installed via pip or with distro packages (depending on your distro). You can mix and match and install Molecule via pip and specific components (like <code>ansible</code> or <code>ansible-lint</code>) via your distro&rsquo;s package manager.</p>

<p><strong>Notes:</strong></p>

<ul>
<li><em>On Windows Molecule can only be installed via WSL</em></li>
<li><em>I&rsquo;m assuming you already have Ansible installed and will not cover it here</em></li>
</ul>

<h3 id="windows-install-ubuntu-wsl">Windows Install (Ubuntu WSL)</h3>

<p>On Ubuntu Molecule needs to be installed via pip. If perhaps you are running another distro in WSL, you can check if the packages are available with your package manager (if you choose to install that way).</p>

<p>Install <code>python-pip</code>.</p>

<pre><code class="language-none">$ sudo apt install -y python-pip
</code></pre>

<p>Create a python virtual environment for Molecule. The software we are going to install will reside in the virtual environment (we can use the environment many times).</p>

<pre><code class="language-none">$ python3 -m venv molecule
</code></pre>

<p>Activate the environment (see that the prompt changes).</p>

<pre><code class="language-none">$ source molecule/bin/activate
(molecule-venv) $
</code></pre>

<p>Install the wheel package.</p>

<pre><code class="language-none">(molecule-venv) $ python3 -m pip install wheel
</code></pre>

<p>Install ansible and ansible-lint. You can do this via Python/Molecule, or via the OS.</p>

<p><em>OS</em></p>

<pre><code class="language-none">$ apt install ansible ansible-lint
</code></pre>

<p><em>Via molecule</em></p>

<pre><code class="language-none">(molecule-venv) $ python3 -m pip install &quot;molecule[ansible]&quot;  # or molecule[ansible-base]
</code></pre>

<p>Install molecule and docker.</p>

<pre><code class="language-none">(molecule-venv) $ python3 -m pip install &quot;molecule[docker,lint]&quot;
</code></pre>

<h3 id="linux-install-arch">Linux Install (Arch)</h3>

<p>If you are running Arch (I use Arch BTW) you can install everything with <code>pacman</code> (or with pip like we did for Windows WSL).</p>

<pre><code class="language-none">$ sudo /usr/bin/pacman -S yamllint ansible-lint molecule molecule-docker
</code></pre>

<h2 id="getting-started">Getting Started</h2>

<h3 id="creating-a-molecule-role">Creating a Molecule Role</h3>

<p>We will now create and configure a role with Molecule using Docker as the driver.</p>

<p>Run <code>molecule init role [role name] -d docker</code>:</p>

<p><img src="https://blog.victormendonca.com/img/getting-started-with-ansible-molecule/getting-started-with-ansible-molecule-28a74.png" alt="" /></p>

<p>This should have created a new role folder with the required molecule files inside.</p>

<h4 id="molecule-yml">molecule.yml</h4>

<p>Holds the default configuration for molecule.</p>

<p><em><code>./myrole/molecule/default/molecule.yml</code></em></p>

<pre><code class="language-yml">---
dependency:
  name: galaxy
driver:
  name: docker
platforms:
  - name: instance
    image: docker.io/pycontribs/centos:8
    pre_build_image: true
provisioner:
  name: ansible
verifier:
  name: ansible
</code></pre>

<h4 id="converge-yml">converge.yml</h4>

<p>This is the playbook file that molecule will run.</p>

<p><em><code>./myrole/molecule/default/converge.yml</code></em></p>

<pre><code class="language-yml">---
- name: Converge
  hosts: all
  tasks:
    - name: &quot;Include myrole&quot;
      include_role:
        name: &quot;myrole&quot;
</code></pre>

<h2 id="running-a-simple-test">Running a Simple Test</h2>

<p>Let&rsquo;s use the existing configuration in <code>molecule.yml</code> and <code>converge.yml</code> to run a simple test.</p>

<p>Edit the tasks file (<code>myrole/tasks/main.yml</code>) and add a simple task (you can use the example below with the debug module):</p>

<pre><code class="language-yml">---
# tasks file for myrole

- debug:
    msg: &quot;System {{ inventory_hostname }} has uuid {{ ansible_product_uuid }}&quot;
</code></pre>

<p>Run <code>molecule converge</code> (from the role folder) to build the image and run the playbook.</p>

<script id="asciicast-G8PAulZtu6nNtMobEbLypgLwK" src="https://asciinema.org/a/G8PAulZtu6nNtMobEbLypgLwK.js" async></script>

<p>Now that we got the very basic stuff done, let&rsquo;s move into a bit more advanced steps so we can better understand Molecule and use it with our code.</p>

<h2 id="additional-steps-and-configuration">Additional Steps and Configuration</h2>

<h3 id="adding-lint">Adding Lint</h3>

<p>Lint is not enabled by default, but that can be easily changed by editing <code>molecule.yml</code> and adding the <code>lint</code> key to it:</p>

<pre><code class="language-yaml">dependency:
  name: galaxy
driver:
  name: docker
platforms:
  - name: instance
    image: docker.io/pycontribs/centos:8
    pre_build_image: true
provisioner:
  name: ansible
verifier:
  name: ansible
lint: |
  set -e
  yamllint .
  ansible-lint .
</code></pre>

<p>Now run <code>molecule lint</code>. You should get a lot of warnings due to to information missing in the meta folder:</p>

<p><img src="https://blog.victormendonca.com/img/getting-started-with-ansible-molecule/getting-started-with-ansible-molecule-d02b3.png" alt="" /></p>

<p>As instructed by the output of the command, you can quiet or disable the messages by adding a <code>warn_list</code> or <code>skip_list</code> to <code>.ansible_lint</code></p>

<p><em><strong>Tip:</strong> You can also fine tune yaml linting by editing <code>.yamllint</code></em></p>

<h3 id="running-a-full-test">Running a Full Test</h3>

<p>So far we have only run two tests:</p>

<ul>
<li>Converge (dependency, create, prepare converge)</li>
<li>Lint (yaml lint and Ansible lint)</li>
</ul>

<p>Let&rsquo;s run a full test (default scenario) on our role. Remember, the full test will run dependency, lint, syntax, create, prepare, converge, idempotence, side_effect, verify, cleanup and destroy.</p>

<p>Run <code>molecule test</code>.</p>

<script id="asciicast-NYNnPRJaYkEHqUwG0mqxiaUli" src="https://asciinema.org/a/NYNnPRJaYkEHqUwG0mqxiaUli.js" async></script>

<h2 id="running-roles-from-another-folder">Running Roles from Another Folder</h2>

<p>You can also use Molecule to test roles from another folder (which makes molecule very flexible for testing).</p>

<p>Let&rsquo;s say I have the following folder structure:</p>

<pre><code class="language-none">.
 Ansible
     Molecule
     web-project
</code></pre>

<p>Inside my <code>web-project</code> folder I have a role called &lsquo;apache&rsquo; that installs (guess what?) httpd.</p>

<p><em><code>./Ansible/web-project/roles/apache/tasks/main.yml</code></em></p>

<pre><code class="language-yml">---
# tasks file for apache

- name: Installs Apache
  yum:
     name: httpd
     state: present
</code></pre>

<p>I can easily modify my existing <code>converge.yml</code> to include that role:</p>

<p><em><code>./Ansible/Molecule/myrole/molecule/default/converge.yml</code></em></p>

<pre><code class="language-yml">---
- name: Converge
  hosts: all
  tasks:
    - name: &quot;Include myrole&quot;
      include_role:
        name: &quot;../../web-project/roles/apache&quot;
</code></pre>

<p>Also edit <code>molecule.yml</code> so we are linting that external folder:</p>

<p><em><code>./Ansible/Molecule/myrole/molecule/default/molecule.yml</code></em></p>

<pre><code class="language-yml">lint: |
  set -e
  yamllint ../../web-project
  ansible-lint ../../web-project
</code></pre>

<p>And then run <code>molecule converge</code> (from the Molecule role folder) to test. Because <code>molecule converge</code> does not include the <code>destroy</code> command, I can login to the container ( with <code>molecule login</code>) and check if httpd was installed:</p>

<p><img src="https://blog.victormendonca.com/img/getting-started-with-ansible-molecule/getting-started-with-ansible-molecule-d229e.png" alt="" /></p>

<p><em><strong>Tip:</strong></em></p>

<ul>
<li><em>When testing against multiple containers you can use <code>molecule login --host [container name]</code></em></li>
<li><em>You can also use docker cli to connect to the container - <code>docker exec -ti [container name] /bin/bash</code></em></li>
</ul>

<p><em><strong>Note:</strong> On this example nothing other than the role is imported (e.g. variables and config from <code>ansible.cfg</code> are not imported)</em></p>

<h3 id="additional-container-configuration">Additional Container Configuration</h3>

<p>We can configure different options for our container in <code>molecule.yml</code> under the platforms key section. Configuration here is similar to a docker compose file.</p>

<ul>
<li><strong>name</strong> - Name of the container</li>
<li><strong>image</strong> - Image for the container. Can be local or from a remote registry</li>
<li><strong>pre_build_image</strong> - Instructs to use pre-build image (pull or local) instead of building from <code>molecule/default/Dockerfile.j2</code></li>
<li><strong>privileged</strong> - Give extended privileges (a &ldquo;privileged&rdquo; container is given access to all devices)</li>
<li><strong>capabilities</strong> - Same as <code>--cap-add=SYS_ADMIN</code>. Grants a smaller subset of capabilities to the container compared to the privileged option</li>
<li><strong>command</strong> - Same as Dockerfile <code>RUN</code></li>
<li><strong>groups</strong> - Assigns the container to one or more Ansible groups</li>
</ul>

<p>Example:</p>

<pre><code class="language-yml">---
dependency:
  name: galaxy
driver:
  name: podman
platforms:
  - name: rhel8
    image: registry.access.redhat.com/ubi8/ubi-init
    tmpfs:
      - /run
      - /tmp
    volumes:
      - /sys/fs/cgroup:/sys/fs/cgroup:ro
    capabilities:
      - SYS_ADMIN
    command: &quot;/usr/sbin/init&quot;
    pre_build_image: true
  - name: ubuntu
    image: geerlingguy/docker-ubuntu2004-ansible
    tmpfs:
      - /run
      - /tmp
    volumes:
      - /sys/fs/cgroup:/sys/fs/cgroup:ro
    capabilities:
      - SYS_ADMIN
    command: &quot;/lib/systemd/systemd&quot;
    pre_build_image: true
provisioner:
  name: ansible
verifier:
  name: ansible
lint: |
  set -e
  yamllint .
  ansible-lint .
</code></pre>

<hr />

<h2 id="conclusion">Conclusion</h2>

<p>I&rsquo;m hoping I was able to provide you with enough information on how to get started with Molecule. If you have any comments, suggestions or corrections, please leave them in the comment box below.</p>

</div>


          <footer>
  
<span class="share-box">Share this on:
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.victormendonca.com%2f2021%2f02%2f28%2fgetting-started-with-ansible-molecule%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-facebook-official "></i></a>

    <a href="https://twitter.com/intent/tweet?text=Getting%20Started%20with%20Ansible%20Molecule&amp;url=https%3a%2f%2fblog.victormendonca.com%2f2021%2f02%2f28%2fgetting-started-with-ansible-molecule%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-twitter"></i></a>

    <a href="https://plus.google.com/share?url=https%3a%2f%2fblog.victormendonca.com%2f2021%2f02%2f28%2fgetting-started-with-ansible-molecule%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-google-plus"></i></a>

    <a href="http://www.reddit.com/submit?url=https%3a%2f%2fblog.victormendonca.com%2f2021%2f02%2f28%2fgetting-started-with-ansible-molecule%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-reddit"></i></a>

    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblog.victormendonca.com%2f2021%2f02%2f28%2fgetting-started-with-ansible-molecule%2f&amp;title=Getting%20Started%20with%20Ansible%20Molecule" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-linkedin"></i></a>

    <a href="mailto:?subject=Getting%20Started%20with%20Ansible%20Molecule&amp;body=Check out this site https%3a%2f%2fblog.victormendonca.com%2f2021%2f02%2f28%2fgetting-started-with-ansible-molecule%2f" data-proofer-ignore=""><i class="fa fa-envelope"></i></a>
  </span>

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
      
  
    <nav><ul class="pager">
    
        <li class="previous">
          <a href="https://blog.victormendonca.com/2021/01/23/how-to-convert-standard-partition-to-lvm/" title="How to Convert Standard Partition to Logical Volume">
            <span aria-hidden="true">&larr;</span>Previous
          </a>
        </li>
    

    
      <li class="next">
        <a href="https://blog.victormendonca.com/2022/11/18/linux-find-command/" title="Linux find Command">
            Next <span aria-hidden="true">&rarr;</span>
        </a>
      </li>
    
    </ul> </nav>
  


</div>

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
  

</div>

</footer>

        
        
<nav>
  <ul class="pagination">
    


<li >
  <a aria-label="First" href="https://blog.victormendonca.com//">
    <span aria-hidden="true">&laquo;&laquo;</span>
  </a>
</li>

<li >
  <a aria-label="Previous" href="https://blog.victormendonca.com//">
    <span aria-hidden="true">&laquo;</span>
    </a>
</li>

<li >
  <a href="https://blog.victormendonca.com//">
    1
    </a>
</li>

<li  class="active" >
  <a href="https://blog.victormendonca.com//page/2/">
    2
    </a>
</li>

<li >
  <a href="https://blog.victormendonca.com//page/3/">
    3
    </a>
</li>

<li >
  <a href="https://blog.victormendonca.com//page/4/">
    4
    </a>
</li>

<li >
  <a href="https://blog.victormendonca.com//page/5/">
    5
    </a>
</li>

<li >
  <a href="https://blog.victormendonca.com//page/6/">
    6
    </a>
</li>

<li >
  <a href="https://blog.victormendonca.com//page/7/">
    7
    </a>
</li>

<li >
  <a href="https://blog.victormendonca.com//page/8/">
    8
    </a>
</li>

<li >
  <a href="https://blog.victormendonca.com//page/9/">
    9
    </a>
</li>

<li >
  <a href="https://blog.victormendonca.com//page/10/">
    10
    </a>
</li>

<li >
  <a href="https://blog.victormendonca.com//page/11/">
    11
    </a>
</li>

<li >
  <a href="https://blog.victormendonca.com//page/12/">
    12
    </a>
</li>

<li >
  <a href="https://blog.victormendonca.com//page/13/">
    13
    </a>
</li>

<li >
  <a href="https://blog.victormendonca.com//page/14/">
    14
    </a>
</li>

<li >
  <a href="https://blog.victormendonca.com//page/15/">
    15
    </a>
</li>


<li >
  <a aria-label="Next" href="https://blog.victormendonca.com//page/3/">
    <span aria-hidden="true">&raquo;</span>
    </a>
</li>
<li >
  <a aria-label="Last" href="https://blog.victormendonca.com//page/15/">
    <span aria-hidden="true">&raquo;&raquo;</span>
  </a>
</li>


  </ul>
</nav>


      </div>
      
        <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
          <div>
  

   
    <div class="section">
      <header><div class="title"></div></header>
      <div class="content">
        <img style="float: center; padding-right: 5px;" src="https://blog.victormendonca.com/img/avatar.jpg" hspace="20" width="240"></img>
        <br/>
        <div class="social-icons" style="display:inline-block; text-align: center; width:100%;">
        <a href="https://github.com/victorbrca" target="_blank"><i class="fa fa-github fa-2x" style="padding-right: 5px; padding-left: 5px" aria-hidden="true"></i></a>
        <a href="https://twitter.com/victorbrca" target="_blank"><i class="fa fa-twitter fa-2x" style="padding-right: 5px; padding-left: 1px" aria-hidden="true"></i></a>
        <a href="http://www.linkedin.com/in/victormendonca" target="_blank"><i class="fa fa-linkedin-square fa-2x" style="padding-right: 5px; padding-left: 1px" aria-hidden="true"></i></a>
        <a href="https://www.facebook.com/victormendonca" target="_blank"><i class="fa fa-facebook-official fa-2x" style="padding-right: 5px; padding-left: 1px" aria-hidden="true"></i></a>
        <div>
        <br/>
      </div>
    </div>

    
      
      
      <div class="section taxonomies">
        <header><div class="title"><b>tags</b></div></header>

        <div class="content1">
          <ul>
            <li><a href="https://blog.victormendonca.com/tags/linux">linux</a></li><li><a href="https://blog.victormendonca.com/tags/bash">bash</a></li><li><a href="https://blog.victormendonca.com/tags/hardware">hardware</a></li><li><a href="https://blog.victormendonca.com/tags/redhat">redhat</a></li><li><a href="https://blog.victormendonca.com/tags/rhcsa">rhcsa</a></li><li><a href="https://blog.victormendonca.com/tags/networking">networking</a></li><li><a href="https://blog.victormendonca.com/tags/ansible">ansible</a></li><li><a href="https://blog.victormendonca.com/tags/freenas">freenas</a></li><li><a href="https://blog.victormendonca.com/tags/kde">kde</a></li><li><a href="https://blog.victormendonca.com/tags/monitoring">monitoring</a></li><li><a href="https://blog.victormendonca.com/tags/shell">shell</a></li><li><a href="https://blog.victormendonca.com/tags/storage">storage</a></li><li><a href="https://blog.victormendonca.com/tags/vim">vim</a></li><li><a href="https://blog.victormendonca.com/tags/arch">arch</a></li><li><a href="https://blog.victormendonca.com/tags/docker">docker</a></li><li><a href="https://blog.victormendonca.com/tags/macos">macos</a></li><li><a href="https://blog.victormendonca.com/tags/pfsense">pfsense</a></li><li><a href="https://blog.victormendonca.com/tags/systemd">systemd</a></li><li><a href="https://blog.victormendonca.com/tags/virtualbox">virtualbox</a></li><li><a href="https://blog.victormendonca.com/tags/administration">administration</a></li>
          </ul>
        </div>
      </div>
      
    
      
      
    

    <br />

    <div class="section">
      <header><div class="title"><b>Latest Posts</b></div></header>
      <div class="content">
        <ul>
        
          <li>
          <a href="https://blog.victormendonca.com/2025/08/22/top-skills-that-will-make-you-stand-out-as-a-linux-admin-part-1/">Top Skills That Will Make You Stand Out as a Linux Admin: Part 1</a>
          </li>
        
          <li>
          <a href="https://blog.victormendonca.com/2024/09/09/logrotate-simplifying-log-management/">Logrotate: Simplifying Log Management</a>
          </li>
        
          <li>
          <a href="https://blog.victormendonca.com/2024/02/14/getting-started-with-ansible-console/">Getting Started with Ansible Console</a>
          </li>
        
          <li>
          <a href="https://blog.victormendonca.com/2023/12/21/playing-a-sound-on-headless-server-boot/">Playing a Sound on Headless Server Boot</a>
          </li>
        
          <li>
          <a href="https://blog.victormendonca.com/2023/11/27/rhce-v8-practiceexam/">RHCE v8 Practice Exam</a>
          </li>
        
          <li>
          <a href="https://blog.victormendonca.com/2023/11/21/testing-new-hard-drives/">Testing New Hard Drives</a>
          </li>
        
          <li>
          <a href="https://blog.victormendonca.com/2023/07/20/how-to-migrate-local-users-and-grops/">How to Migrate Local Users and Grops</a>
          </li>
        
        </ul>
      </div>
    </div>

    <br />

    
    <div class="section">
    
      
      <div class="content" align="center" >
        <a class="twitter-timeline" data-width="240" data-height="450" href="https://twitter.com/victorbrca">Tweets by victorbrca</a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
      </div>
    </div>

</div>

        </div>
      
    </div>

  </div>

    
<footer class="footer hidden-print">
  <div class="container">
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
           <div class="pull-left">
  <a class="toplink" href="javascript:" id="return-to-top">back to top</a>
</div>
<div class="pull-right">

</div>

        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 text-center">
              
    
<div class="container footline">
    <small>
  code with <i class='fa fa-linux'></i>

</small>
</div>


    
<div class="container copyright">
    <small>
  &copy; 2018 Copyright Victor Mendona

  </small>
</div>



        </div>
    </div>
  </div>
</footer>

    

<script src="https://blog.victormendonca.com/js/jquery.min.js"></script>
<script src="https://blog.victormendonca.com/js/bootstrap.min.js"></script>


<script src="https://blog.victormendonca.com/js/highlight.pack.js"></script>
<script src="https://blog.victormendonca.com/js/site.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script>
var ENABLE_POPOVER =  false , 
EXPIRE_COOKIE =  5 , 
SHOW_MODAL_TIMEOUT =  10000 , 
MOUSE_LEAVE =  true , 
MODAL_SIZE = "", 
POST_URL = "https://zapier.com/hooks/catch/1227563/", 
SIGNUP_HEADER = "Join Our Newsletter",
HEADER_IMAGE = "//placehold.it/1000x600",
IMG_DESCRIPTION = "Placeholder image for this popover modal optin form",
SIGNUP_TEXT = "Signup today for free and be the first to get notified on new updates.",
INPUT_PLACEHOLDER = "Enter your email",
SUBMIT_BUTTON = "Subscribe",
SUCCESS_MESSAGE = "Thanks for your subscription!",
ERROR_MESSAGE = "Submitting form failed!",
OPTIN =  true ,
COOKIE_NAME = "mycookie1",
CONTENTLANGUAGE = ""; 
</script>





<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/config/TeX-AMS-MML_HTMLorMML.js"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    for(var all in MathJax.Hub.getAllJax()) {
        all.SourceElement().parentNode.className += ' has-jax';

    }
});
</script>






  </body>
</html>

